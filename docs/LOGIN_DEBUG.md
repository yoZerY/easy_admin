# ç™»å½•è·³è½¬è°ƒè¯•æŒ‡å—

## ğŸ› é—®é¢˜æè¿°

ç™»å½•æˆåŠŸä½†æ²¡æœ‰è·³è½¬åˆ°é¦–é¡µã€‚

## ğŸ” è°ƒè¯•æ­¥éª¤

### 1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°

æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œåˆ‡æ¢åˆ° Console æ ‡ç­¾ã€‚

### 2. æ¸…é™¤ç¼“å­˜

```javascript
// åœ¨æ§åˆ¶å°æ‰§è¡Œ
localStorage.clear()
sessionStorage.clear()
location.reload()
```

### 3. é‡æ–°ç™»å½•

ä½¿ç”¨æµ‹è¯•è´¦å·ç™»å½•ï¼š

- ç”¨æˆ·åï¼š`admin`
- å¯†ç ï¼š`admin`

### 4. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

ç™»å½•è¿‡ç¨‹ä¸­ä¼šè¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š

```
ğŸ” å¼€å§‹ç™»å½•...
ğŸ” æ­¥éª¤1: è°ƒç”¨ç™»å½•æ¥å£...
âœ… ç™»å½•æˆåŠŸï¼Œè·å–åˆ° Token: {...}
ğŸ‘¤ æ­¥éª¤2: è·å–ç”¨æˆ·ä¿¡æ¯...
âœ… ç”¨æˆ·ä¿¡æ¯è·å–æˆåŠŸ: {...}
ğŸ“‹ æ­¥éª¤3: è·å–ç”¨æˆ·èœå•...
âœ… èœå•è·å–æˆåŠŸ: [...]
ğŸ›£ï¸ æ­¥éª¤4: ç”ŸæˆåŠ¨æ€è·¯ç”±...
ğŸ”„ å¼€å§‹ç”ŸæˆåŠ¨æ€è·¯ç”±...
âœ… è·¯ç”±åˆå¹¶å®Œæˆ
âœ… ç™»å½•æˆåŠŸï¼Œå‡†å¤‡è·³è½¬...
ğŸ”„ è·³è½¬ç›®æ ‡: /
ğŸ›£ï¸ è·¯ç”±å®ˆå«: ä» /login åˆ° /
âœ… å·²ç™»å½•ï¼Œæ£€æŸ¥ç”¨æˆ·ä¿¡æ¯å’Œèœå•...
ç”¨æˆ·ä¿¡æ¯: {...}
èœå•æ•°é‡: 7
âœ… è·¯ç”±å®ˆå«æ”¾è¡Œï¼Œè·³è½¬åˆ°: /
âœ… è·³è½¬å®Œæˆ
è·¯ç”±è·³è½¬å®Œæˆ: /
```

## ğŸ¯ å¯èƒ½çš„é—®é¢˜

### é—®é¢˜ 1ï¼šè·¯ç”±å®ˆå«é˜»æ­¢è·³è½¬

**ç—‡çŠ¶**ï¼šçœ‹åˆ° `âŒ æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µ` æˆ– `âŒ æ²¡æœ‰æƒé™`

**è§£å†³**ï¼š

1. æ£€æŸ¥ `userStore.isLogin` æ˜¯å¦ä¸º `true`
2. æ£€æŸ¥ `userStore.userInfo` æ˜¯å¦å­˜åœ¨
3. æ£€æŸ¥ `menuStore.getMenus` æ˜¯å¦æœ‰æ•°æ®

```javascript
// åœ¨æ§åˆ¶å°æ£€æŸ¥
import { useUserStore } from '@/stores/modules/user'
import { useMenuStore } from '@/stores/modules/menu'

const userStore = useUserStore()
const menuStore = useMenuStore()

console.log('isLogin:', userStore.isLogin)
console.log('userInfo:', userStore.userInfo)
console.log('menus:', menuStore.getMenus)
```

### é—®é¢˜ 2ï¼šè·¯ç”±ä¸å­˜åœ¨

**ç—‡çŠ¶**ï¼šçœ‹åˆ° 404 é¡µé¢æˆ–ç©ºç™½é¡µ

**è§£å†³**ï¼š

1. æ£€æŸ¥è·¯ç”±æ˜¯å¦æ­£ç¡®å®šä¹‰
2. æ£€æŸ¥è·¯ç”±è·¯å¾„æ˜¯å¦æ­£ç¡®

```javascript
// åœ¨æ§åˆ¶å°æ£€æŸ¥
import router from '@/router'

console.log('æ‰€æœ‰è·¯ç”±:', router.getRoutes())
console.log('å½“å‰è·¯ç”±:', router.currentRoute.value)
```

### é—®é¢˜ 3ï¼šæƒé™ä¸è¶³

**ç—‡çŠ¶**ï¼šè·³è½¬åˆ° 403 é¡µé¢

**è§£å†³**ï¼š

1. æ£€æŸ¥ç”¨æˆ·è§’è‰²å’Œæƒé™
2. æ£€æŸ¥è·¯ç”±çš„æƒé™é…ç½®

```javascript
// åœ¨æ§åˆ¶å°æ£€æŸ¥
const userStore = useUserStore()

console.log('è§’è‰²:', userStore.roles)
console.log('æƒé™:', userStore.permissions)
```

### é—®é¢˜ 4ï¼šèœå•æœªåŠ è½½

**ç—‡çŠ¶**ï¼šä¾§è¾¹æ æ²¡æœ‰èœå•

**è§£å†³**ï¼š

1. æ£€æŸ¥èœå•æ•°æ®æ˜¯å¦è·å–æˆåŠŸ
2. æ£€æŸ¥èœå•æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®

```javascript
// åœ¨æ§åˆ¶å°æ£€æŸ¥
const menuStore = useMenuStore()

console.log('èœå•æ•°æ®:', menuStore.getMenus)
console.log('èœå•æ•°é‡:', menuStore.getMenus.length)
```

## ğŸ”§ æ‰‹åŠ¨æµ‹è¯•

### 1. æµ‹è¯•ç™»å½•

```javascript
import { useUserStore } from '@/stores/modules/user'

const userStore = useUserStore()

// ç™»å½•
const result = await userStore.login('admin', 'admin')
console.log('ç™»å½•ç»“æœ:', result)
```

### 2. æµ‹è¯•è·³è½¬

```javascript
import { useRouter } from 'vue-router'

const router = useRouter()

// è·³è½¬åˆ°é¦–é¡µ
await router.push('/')
console.log('å½“å‰è·¯ç”±:', router.currentRoute.value.path)
```

### 3. æµ‹è¯•èœå•

```javascript
import { useMenuStore } from '@/stores/modules/menu'

const menuStore = useMenuStore()

console.log('èœå•åˆ—è¡¨:', menuStore.getMenus)
```

## ğŸ“ å¸¸è§é”™è¯¯ä¿¡æ¯

### é”™è¯¯ 1ï¼š`Cannot read property 'push' of undefined`

**åŸå› **ï¼šrouter æœªæ­£ç¡®åˆå§‹åŒ–

**è§£å†³**ï¼šæ£€æŸ¥ `src/main.ts` ä¸­æ˜¯å¦æ­£ç¡®æ³¨å†Œäº† router

### é”™è¯¯ 2ï¼š`Navigation cancelled from "/login" to "/" with a new navigation`

**åŸå› **ï¼šè·¯ç”±å®ˆå«ä¸­æœ‰å¤šæ¬¡ `next()` è°ƒç”¨

**è§£å†³**ï¼šæ£€æŸ¥è·¯ç”±å®ˆå«é€»è¾‘ï¼Œç¡®ä¿æ¯ä¸ªåˆ†æ”¯åªè°ƒç”¨ä¸€æ¬¡ `next()`

### é”™è¯¯ 3ï¼š`Uncaught (in promise) Error: Redirected when going from "/login" to "/" via a navigation guard`

**åŸå› **ï¼šè·¯ç”±å®ˆå«ä¸­æœ‰é‡å®šå‘å¾ªç¯

**è§£å†³**ï¼šæ£€æŸ¥è·¯ç”±å®ˆå«é€»è¾‘ï¼Œé¿å…å¾ªç¯é‡å®šå‘

## ğŸ¯ é¢„æœŸè¡Œä¸º

æ­£å¸¸çš„ç™»å½•æµç¨‹åº”è¯¥æ˜¯ï¼š

1. âœ… ç”¨æˆ·åœ¨ç™»å½•é¡µè¾“å…¥è´¦å·å¯†ç 
2. âœ… ç‚¹å‡»ç™»å½•æŒ‰é’®
3. âœ… è°ƒç”¨ç™»å½•æ¥å£ï¼Œè·å– Token
4. âœ… è·å–ç”¨æˆ·ä¿¡æ¯å’Œæƒé™
5. âœ… è·å–ç”¨æˆ·èœå•
6. âœ… ç”ŸæˆåŠ¨æ€è·¯ç”±
7. âœ… æ˜¾ç¤º"ç™»å½•æˆåŠŸ"æç¤º
8. âœ… è·³è½¬åˆ°é¦–é¡µï¼ˆ`/`ï¼‰
9. âœ… è·¯ç”±å®ˆå«æ£€æŸ¥é€šè¿‡
10. âœ… æ˜¾ç¤ºé¦–é¡µå†…å®¹å’Œä¾§è¾¹æ èœå•

## ğŸ’¡ è°ƒè¯•æŠ€å·§

### 1. ä½¿ç”¨ Vue DevTools

å®‰è£… Vue DevTools æµè§ˆå™¨æ’ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹ï¼š

- Pinia Store çŠ¶æ€
- è·¯ç”±ä¿¡æ¯
- ç»„ä»¶æ ‘

### 2. ä½¿ç”¨æ–­ç‚¹è°ƒè¯•

åœ¨å…³é”®ä½ç½®è®¾ç½®æ–­ç‚¹ï¼š

- `src/views/login/index.vue` çš„ `handleLogin` æ–¹æ³•
- `src/router/guard.ts` çš„ `beforeEach` å®ˆå«
- `src/stores/modules/user.ts` çš„ `login` æ–¹æ³•

### 3. æŸ¥çœ‹ç½‘ç»œè¯·æ±‚

æ‰“å¼€ Network æ ‡ç­¾ï¼ŒæŸ¥çœ‹ï¼š

- ç™»å½•æ¥å£æ˜¯å¦æˆåŠŸ
- è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£æ˜¯å¦æˆåŠŸ
- è·å–èœå•æ¥å£æ˜¯å¦æˆåŠŸ

## ğŸ†˜ å¦‚æœè¿˜æ˜¯ä¸è¡Œ

1. æ¸…é™¤æ‰€æœ‰ç¼“å­˜å’Œ Cookie
2. é‡å¯å¼€å‘æœåŠ¡å™¨
3. æ£€æŸ¥æ˜¯å¦æœ‰ JavaScript é”™è¯¯
4. æ£€æŸ¥è·¯ç”±é…ç½®æ˜¯å¦æ­£ç¡®
5. æŸ¥çœ‹å®Œæ•´çš„æ§åˆ¶å°æ—¥å¿—

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æä¾›ï¼š

1. å®Œæ•´çš„æ§åˆ¶å°æ—¥å¿—
2. ç½‘ç»œè¯·æ±‚æˆªå›¾
3. é”™è¯¯ä¿¡æ¯æˆªå›¾
4. æµè§ˆå™¨ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿä¿¡æ¯
